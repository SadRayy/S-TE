<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sadrayy Eğlence & Haber Sitesi</title>
<style>
  body { font-family: Arial, sans-serif; background-color: #f0f0f0; margin: 0; padding: 0;}
  .container { max-width: 500px; margin: 50px auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.2);}
  h2 { color: red; text-align: center; }
  input { width: 100%; padding: 10px; margin: 10px 0; border-radius: 5px; border: 1px solid #ccc; }
  button { padding: 10px 20px; border: none; border-radius: 5px; background: red; color: #fff; cursor: pointer; margin: 5px 0; }
  #newsList { margin-top: 20px; }
  .newsItem { background: #eee; padding: 10px; margin: 5px 0; border-radius: 5px; }
</style>
</head>
<body>

<div class="container" id="registerDiv">
  <h2>Kayıt Ol</h2>
  <input type="text" id="regNickname" placeholder="Nickname">
  <input type="password" id="regPassword" placeholder="Şifre">
  <button id="registerBtn">Kayıt Ol</button>
</div>

<div class="container" id="loginDiv" style="display:none;">
  <h2>Giriş Yap</h2>
  <input type="text" id="loginNickname" placeholder="Nickname">
  <input type="password" id="loginPassword" placeholder="Şifre">
  <button id="loginBtn">Giriş Yap</button>
</div>

<div class="container" id="newsDiv" style="display:none;">
  <h2>Haber Akışı</h2>
  <div id="newsList"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
import { getFirestore, doc, setDoc, getDoc, collection, getDocs } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

// Firebase Konfigürasyonu
const firebaseConfig = {
  apiKey: "AIzaSyALAEYsysXJy0mnNmJvD5H0wOqXjp4Oohc",
  authDomain: "sadrayy-site.firebaseapp.com",
  projectId: "sadrayy-site",
  storageBucket: "sadrayy-site.firebasestorage.app",
  messagingSenderId: "302147777701",
  appId: "1:302147777701:web:d701293a09ab61d85f894c",
  measurementId: "G-C9HVQ0XXBJ"
};

// Firebase Başlat
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Global fonksiyonlar
window.registerUser = async function() {
  const nickname = document.getElementById("regNickname").value;
  const password = document.getElementById("regPassword").value;
  if(!nickname || !password){ alert("Lütfen tüm alanları doldurun."); return; }
  
  await setDoc(doc(db, "users", nickname), { password });
  alert("Kayıt başarılı! Giriş ekranına yönlendiriliyorsunuz.");
  document.getElementById("registerDiv").style.display = "none";
  document.getElementById("loginDiv").style.display = "block";
}

window.loginUser = async function() {
  const nickname = document.getElementById("loginNickname").value;
  const password = document.getElementById("loginPassword").value;
  if(!nickname || !password){ alert("Lütfen tüm alanları doldurun."); return; }

  const userDoc = await getDoc(doc(db, "users", nickname));
  if(!userDoc.exists()) { alert("Kullanıcı bulunamadı!"); return; }
  if(userDoc.data().password !== password){ alert("Şifre yanlış!"); return; }

  alert("Giriş başarılı!");
  document.getElementById("loginDiv").style.display = "none";
  document.getElementById("newsDiv").style.display = "block";
  loadNews();
}

// Haberleri çek
async function loadNews() {
  const newsList = document.getElementById("newsList");
  newsList.innerHTML = "";
  const querySnapshot = await getDocs(collection(db, "news"));
  querySnapshot.forEach((doc) => {
    const div = document.createElement("div");
    div.className = "newsItem";
    div.innerHTML = `<strong>${doc.data().title}</strong><p>${doc.data().content}</p>`;
    newsList.appendChild(div);
  });
}

// Event listener ekle
document.getElementById("registerBtn").addEventListener("click", registerUser);
document.getElementById("loginBtn").addEventListener("click", loginUser);
</script>
</body>
</html>
